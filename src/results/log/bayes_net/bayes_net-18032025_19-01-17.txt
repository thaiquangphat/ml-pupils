2025-03-18 19:01:35,925 - Model configuration: {'discretize_features': True, 'bins': 5, 'estimator': 'bayes', 'naive': False, 'chunk_size': 1000, 'output_dir': 'features/output', 'visualization': {'enabled': True, 'type': 'network', 'output_file': 'results/visualizations/bayes_net_structure.png', 'show': True}}
2025-03-18 19:01:35,926 - === Start Bayesian Network Training ===
2025-03-18 19:01:35,937 - Loaded 5712 training samples
2025-03-18 19:01:35,956 - Using Bayesian Estimator with BDeu prior...
2025-03-18 19:01:35,977 - CPDs after training:
2025-03-18 19:01:35,977 - 
Node: tumor_type
+------------------------+----------+
| tumor_type(glioma)     | 0.279211 |
+------------------------+----------+
| tumor_type(meningioma) | 0.231284 |
+------------------------+----------+
| tumor_type(notumor)    | 0.255073 |
+------------------------+----------+
| tumor_type(pituitary)  | 0.234432 |
+------------------------+----------+
2025-03-18 19:01:35,978 - 
Node: area
+------------+---------------------+-----+-----------------------+
| tumor_type | tumor_type(glioma)  | ... | tumor_type(pituitary) |
+------------+---------------------+-----+-----------------------+
| area(0)    | 0.09416601409553642 | ... | 0.23302555493378102   |
+------------+---------------------+-----+-----------------------+
| area(1)    | 0.12486296006264683 | ... | 0.32554560716284275   |
+------------+---------------------+-----+-----------------------+
| area(2)    | 0.2125685199686766  | ... | 0.32853012497668344   |
+------------+---------------------+-----+-----------------------+
| area(3)    | 0.5684025058731401  | ... | 0.11289871292669278   |
+------------+---------------------+-----+-----------------------+
2025-03-18 19:01:35,978 - 
Node: eccentricity
+-----------------+---------------------+-----+-----------------------+
| tumor_type      | tumor_type(glioma)  | ... | tumor_type(pituitary) |
+-----------------+---------------------+-----+-----------------------+
| eccentricity(0) | 0.3140563821456539  | ... | 0.1457284088789405    |
+-----------------+---------------------+-----+-----------------------+
| eccentricity(1) | 0.3648003132341425  | ... | 0.2181029658645775    |
+-----------------+---------------------+-----+-----------------------+
| eccentricity(2) | 0.12047768206734534 | ... | 0.35912143256855067   |
+-----------------+---------------------+-----+-----------------------+
| eccentricity(3) | 0.20066562255285827 | ... | 0.2770471926879314    |
+-----------------+---------------------+-----+-----------------------+
2025-03-18 19:01:35,978 - 
Node: homogeneity
+----------------+---------------------+-----+-----------------------+
| tumor_type     | tumor_type(glioma)  | ... | tumor_type(pituitary) |
+----------------+---------------------+-----+-----------------------+
| homogeneity(0) | 0.0778778386844166  | ... | 0.23451781384070136   |
+----------------+---------------------+-----+-----------------------+
| homogeneity(1) | 0.332850430696946   | ... | 0.22854877821301997   |
+----------------+---------------------+-----+-----------------------+
| homogeneity(2) | 0.3466327329678935  | ... | 0.2270565193060996    |
+----------------+---------------------+-----+-----------------------+
| homogeneity(3) | 0.24263899765074393 | ... | 0.3098768886401791    |
+----------------+---------------------+-----+-----------------------+
2025-03-18 19:01:35,978 - 
Node: contrast
+-------------+---------------------+-----+-----------------------+
| tumor_type  | tumor_type(glioma)  | ... | tumor_type(pituitary) |
+-------------+---------------------+-----+-----------------------+
| contrast(0) | 0.2852388410336727  | ... | 0.1793042342846484    |
+-------------+---------------------+-----+-----------------------+
| contrast(1) | 0.4374706342991386  | ... | 0.19571908226077225   |
+-------------+---------------------+-----+-----------------------+
| contrast(2) | 0.14052466718872358 | ... | 0.3427065845924268    |
+-------------+---------------------+-----+-----------------------+
| contrast(3) | 0.13676585747846515 | ... | 0.2822700988621526    |
+-------------+---------------------+-----+-----------------------+
2025-03-18 19:01:35,979 - 
Node: perimeter
+--------------+------------------------+-----+-----------------------+-----------------------+
| area         | area(0)                | ... | area(2)               | area(3)               |
+--------------+------------------------+-----+-----------------------+-----------------------+
| perimeter(0) | 0.9748780487804878     | ... | 0.0002738225629791895 | 0.0002731046537032991 |
+--------------+------------------------+-----+-----------------------+-----------------------+
| perimeter(1) | 0.024850948509485094   | ... | 0.05810514786418401   | 0.0002731046537032991 |
+--------------+------------------------+-----+-----------------------+-----------------------+
| perimeter(2) | 0.00013550135501355014 | ... | 0.773986856516977     | 0.1671946689971597    |
+--------------+------------------------+-----+-----------------------+-----------------------+
| perimeter(3) | 0.00013550135501355014 | ... | 0.16763417305585981   | 0.8322591216954337    |
+--------------+------------------------+-----+-----------------------+-----------------------+
2025-03-18 19:01:35,979 - 
Node: solidity
+--------------+---------------------+---------------------+---------------------+---------------------+
| eccentricity | eccentricity(0)     | eccentricity(1)     | eccentricity(2)     | eccentricity(3)     |
+--------------+---------------------+---------------------+---------------------+---------------------+
| solidity(0)  | 0.7069710224166211  | 0.112234856767986   | 0.147222829652307   | 0.3262508193139611  |
+--------------+---------------------+---------------------+---------------------+---------------------+
| solidity(1)  | 0.1090486604702023  | 0.2583096435600262  | 0.21020118084408485 | 0.3131417959362027  |
+--------------+---------------------+---------------------+---------------------+---------------------+
| solidity(2)  | 0.07668124658283215 | 0.23994095779575772 | 0.32041329542969604 | 0.28604981428883547 |
+--------------+---------------------+---------------------+---------------------+---------------------+
| solidity(3)  | 0.10729907053034445 | 0.38951454187623    | 0.32216269407391207 | 0.07455757046100066 |
+--------------+---------------------+---------------------+---------------------+---------------------+
2025-03-18 19:01:35,979 - 
Node: energy
+-------------+-----------------------+-----+---------------------+-----------------------+
| homogeneity | homogeneity(0)        | ... | homogeneity(2)      | homogeneity(3)        |
+-------------+-----------------------+-----+---------------------+-----------------------+
| energy(0)   | 0.8902405686167304    | ... | 0.00552153947080691 | 0.0002731046537032991 |
+-------------+-----------------------+-----+---------------------+-----------------------+
| energy(1)   | 0.09592673592126845   | ... | 0.12797944456593047 | 0.0037688442211055275 |
+-------------+-----------------------+-----+---------------------+-----------------------+
| energy(2)   | 0.0136960087479497    | ... | 0.7787557402143014  | 0.08417085427135679   |
+-------------+-----------------------+-----+---------------------+-----------------------+
| energy(3)   | 0.0001366867140513942 | ... | 0.08774327574896129 | 0.9117871968538344    |
+-------------+-----------------------+-----+---------------------+-----------------------+
2025-03-18 19:01:35,980 - 
Node: correlation
+----------------+----------------------+-----+----------------------+-----------------------+
| energy         | energy(0)            | ... | energy(2)            | energy(3)             |
+----------------+----------------------+-----+----------------------+-----------------------+
| correlation(0) | 0.6417714598141061   | ... | 0.04045484364749617  | 0.0010924186148131964 |
+----------------+----------------------+-----+----------------------+-----------------------+
| correlation(1) | 0.16763258611262985  | ... | 0.038705445003280124 | 0.009831767533318768  |
+----------------+----------------------+-----+----------------------+-----------------------+
| correlation(2) | 0.1217058501913614   | ... | 0.240760988410234    | 0.23880270919816474   |
+----------------+----------------------+-----+----------------------+-----------------------+
| correlation(3) | 0.021104428649535264 | ... | 0.26787666739558275  | 0.5053528512125847    |
+----------------+----------------------+-----+----------------------+-----------------------+
| correlation(4) | 0.04778567523236742  | ... | 0.41220205554340694  | 0.24492025344111865   |
+----------------+----------------------+-----+----------------------+-----------------------+
2025-03-18 19:01:35,980 - Model saved at results/models/bayes_net/bayes_net_18032025_19-01-35.pkl
2025-03-18 19:01:35,980 - === Bayesian Network training completed in 0.06 seconds ===
2025-03-18 19:01:40,445 - Loading model from results/models/bayes_net/bayes_net_18032025_19-01-35.pkl...
2025-03-18 19:01:40,445 - === Starting Bayesian Network Evaluation ===
2025-03-18 19:01:42,272 - 
              precision    recall  f1-score   support

      glioma       0.57      0.60      0.59       405
  meningioma       0.48      0.32      0.38       300
     notumor       1.00      1.00      1.00       300
   pituitary       0.36      0.45      0.40       306

    accuracy                           0.59      1311
   macro avg       0.60      0.59      0.59      1311
weighted avg       0.60      0.59      0.59      1311

